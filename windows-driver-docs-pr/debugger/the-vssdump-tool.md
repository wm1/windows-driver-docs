---
title: The VSSDump Tool
description: The VSSDump Tool
ms.assetid: b213c949-3433-4686-8323-5af83a6ee5b1
keywords: ["SrcSrv, VSSDump tool", "VSSDump tool"]
ms.author: windowsdriverdev
ms.date: 05/23/2017
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-devices
---

# The VSSDump Tool


The VSSDump (Vssdump.exe) tool is used by the indexing script for Microsoft Visual SourceSafe. It gathers the list of source files to be indexed. This program is also a valuable command-line utility that you can use to examine which files may be processed by the indexing script.

To prepare for source indexing, edit Srcsrv.ini so that it contains an entry for your version control server. This is an operation that you must do only once. Details are listed in the sample version Srcsrv.ini. You can use an environment variable or switch to the indexing script to denote the location of this file. However, it is best to put it in the same directory as the script because the contents of this file are intended to be global across all projects in your business or development system. This file serves to uniquely identify different version control servers. Note that you can provide a different version of this file to debuggers so that they look at a replicated copy of the version control server, which can be useful if you want to reduce traffic on the server.

To source-index a particular build, make certain that no source files are checked out on the build computer. If any files are checked out and edited, those changes are not reflected in the final source indexed .pdb files. Furthermore, if your build process includes a pre-compilation pass that generates source files from other files, you must check in those generated files to version control as part of the pre-compilation.

Upon completion of the build, set the current working directory to be the root of all source files and generated .pdb files. Then run SSIndex. You must specify what version control system you are using as a parameter. For example:

**ssindex.cmd -server=vss**

SSIndex accepts parameters that allow you to run the script from anywhere and to specify the location of the source files and .pdb files separately. This is most useful if the source is kept in another location from the output .pdb files. For example:

**ssindex.cmd -server=vss -source=c:\\***source* **-symbols=c:\\***outputdir*

These directories can also be specified with environment variables. Use the -? or -?? command line options for more information.

Here is an example of the output generated by this script:

```
## C:\ >ssindex.cmd -system=vss -?

SSIndex.cmd [/option=<value> [...]] [ModuleOptions] [/Debug]
General SrcSrv settings:
     NAME              SWITCH      ENV. VAR        Default
  -----------------------------------------------------------------------------
  1) srcsrv.ini        Ini         SRCSRV_INI      .\srcsrv.ini
  2) Source root       Source      SRCSRV_SOURCE   .
  3) Symbols root      Symbols     SRCSRV_SYMBOLS  .
  4) Control system    System      SRCSRV_SYSTEM   <N/A>
  5) Save File (opt.)  Save        SRCSRV_SAVE     <N/A>
  6) Load File (opt.)  Load        SRCSRV_LOAD     <N/A>
Visual Source Safe specific settings:
     NAME            SWITCH      ENV. VAR        Default
  -----------------------------------------------------------------------------
  A) VSS Server      Server      SSDIR            <N/A>
  B) VSS Client      Client      SSROOT           <Current directory>
  C) VSS Project     Project     SSPROJECT        <N/A>
  D) VSS Label       Label       SSLABEL          <N/A>
Precedence is: Default, environment, cmdline switch. (ie. env overrides default,
switch overrides env).
Using '/debug' will turn on verbose output.
Use "SSIndex.cmd -??" for verbose help information.
## See SrcSrv documentation for more information.

```

You can also use one of the provided wrapper scripts (Vssindex.cmd) to avoid specifying the version control system. The script source-indexes all .pdb files found in the current directory and below with version control information to locate all source files found in the current directory and below. You can specify different locations for these files by using environment variables and command-line switches.

Upon completion of the source indexing, you can test the output by running SrcTool on the .pdb files. This program displays data that indicates whether or not the .pdb file is source indexed. It also displays the specific information for every source file. Lastly, it displays the number of indexed sources and the number of sources that no indexing information was found for. It sets an %ERRORLEVEL% of -1 if the file is not source-indexed. Otherwise, it sets %ERRORLEVEL% to the number of indexed source files.

VSSDump can also be used independently to diagnose issues while source-indexing. The syntax is as follows:

**vssdump.exe** *Options*

*Options* can be any combination of the following options.

<span id="-a"></span><span id="-A"></span>**-a**  
Causes all projects to be searched, rather than restricting to the current project. This option may not be used with the **-p** option.

<span id="-p_ProjectName"></span><span id="-p_projectname"></span><span id="-P_PROJECTNAME"></span>**-p** *ProjectName*  
Causes *VSSDump* to restrict its search to the project specified by *ProjectName*. If this option is not present, the current project is used. This option may not be used with the **-a** option.

<span id="-d_RootDirectory"></span><span id="-d_rootdirectory"></span><span id="-D_ROOTDIRECTORY"></span>**-d** *RootDirectory*  
Causes *VSSDump* to restrict its search to the root directory specified by *RootDirectory*. If this option is not present, the current directory is used.

<span id="-l_Label"></span><span id="-l_label"></span><span id="-L_LABEL"></span>**-l** *Label*  
Causes *VSSDump* to list only those files with a label that matches that specified by *Label*.

<span id="VSSDump-v_SharePath"></span><span id="vssdump-v_sharepath"></span><span id="VSSDUMP-V_SHAREPATH"></span>*VSSDump***-v** *SharePath*  
Specifies that the location of the Virtual SourceSafe database is in *SharePath*. This option overrides the path specified in the SSDIR environment variable.

<span id="-r"></span><span id="-R"></span>**-r**  
Causes *VSSDump* to search subdirectories recursively.

<span id="-f"></span><span id="-F"></span>**-f**  
Causes *VSSDump* to list directories containing source files without listing the files themselves.

<span id="-i"></span><span id="-I"></span>**-i**  
Causes *VSSDump* to ignore the current directory and list the entire project. This option may not be used with **-r**.

<span id="-s"></span><span id="-S"></span>**-s**  
Causes *VSSDump* to format output for use with script files.

<span id="-c"></span><span id="-C"></span>**-c**  
Causes *VSSDump* to display only the Virtual SourceSafe configuration information.

 

 

[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[debugger\debugger]:%20The%20VSSDump%20Tool%20%20RELEASE:%20%285/15/2017%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/default.aspx. "Send comments about this topic to Microsoft")




